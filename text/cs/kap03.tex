%%% Třetí kapitola

\chapter{Testování algoritmu na datech}

V této části shrneme výsledky implementace výpočtu Jonesova polynomu na malých uzlech, náhodých uzlech a lincích a na speciálních typech uzlů.
Budeme se zabývat algoritmy A, B, a RND, které byli popsány v sekci~\ref{varianty}.

\section{Malé tabulkové uzly}

\begin{figure}[p]\centering
\includegraphics{../img/multiTable}
\caption{Graf dob běhu algoritmů na tabulkových uzlech do 12 křížení s vyznačenými průměry.}
\label{obr03:multiTable}
\end{figure}

Algoritmy jsme vyzkoušely na všech uzlech, které mají projekci s maximálně dvanácti kříženími. PD notace uzlů byla získána z databáze KnotInfo~\cite{knotinfo}.
U všech tří algoritmů byl už u malých uzlů znatelný exponenciální růst doby běhu, viz graf~\ref{obr03:multiTable}. 

Ze srovnání průměrných dob běhu plyne, že nejlepší čas dosahuje algoritmus A, těsně následuje algoritmus RND a nejpomalejší je algoritmus B, viz graf~\ref{obr03:srovTable}. 
	
\begin{figure}[p]\centering
\includegraphics{../img/srovTable}
\caption{Graf průměrných časů algoritmů na tabulkových uzlech do 12 křížení.}
\label{obr03:srovTable}
\end{figure}


\section{Náhodné uzly a linky}

\subsection{Generování náhodných linků a uzlů}
Náhodné linky jsme generovali pomocí rovinných grafů, neboť mezi linky a rovinnými grafy existuje vzájemně jednoznačná korespondence~\cite{Adams2004}. (Jedná se o jinou korespondenci než mezi linky a rovinnými grafy s vrcholu stupně čtyři popsanou v sekci~\ref{jakograf}).

\subsubsection{Převod rovinného grafu na link}
Rovinný graf s $n$ hranami odpovídá linku s $n$ kříženími. Každé hraně přířadíme náhodně kladné, či záporné znamení a umístíme na ni křížení příslušného typu. Úseky mezi kříženími jsou tím již jednoznačně určené: musí spojovat křížení mezi nejbližšími hranami tak, aby nevznikla žádná další křížení, viz obrázek TODO.

\subsubsection{Generování náhodných rovinných grafů}
Graf s $n$ hranami získáme následujícím způsobem. Vygenerujeme vhodný počet náhodných bodů v rovině a nalezeneme jejich triangulaci, tj. spojíme body hranami tak, aby byl polygon tvořící konvexní obal bodů rozdělen na trojúhelníky.

\begin{figure}[h]  
\centering 
\begin{tikzpicture}
\draw[fill] (1,1) circle [radius=0.05];
\node [below] at (1,1) {$P_1$};

\draw[fill] (2,-1/2) circle [radius=0.05];
\node [below] at (2,-1/2) {$P_2$};

\draw[fill] (2,3) circle [radius=0.05];
\node [above] at (2,3) {$P_3$};

\draw[fill] (-1,3/2) circle [radius=0.05];
\node [above] at (-1,3/2) {$P_4$};

\draw[fill] (-3,3/2) circle [radius=0.05];
\node [above] at (-3,3/2) {$P_5$};

\draw[fill] (-2,-1) circle [radius=0.05];
\node [below] at (-2,-1) {$P_6$};

\draw (-3,3/2) -- (2,3);
\draw (-3,3/2) -- (-1,3/2);
\draw (-3,3/2) -- (-2,-1);
\draw (-1,3/2)  -- (2,3) ;
\draw (-1,3/2)  -- (-2,-1) ;
\draw (-1,3/2)  -- (1,1) ;
\draw (-1,3/2)  -- (1,1) ;
\draw (2,3)   -- (1,1) ;
\draw (-2,-1) -- (1,1) ;
\draw (-2,-1) -- (2,-1/2);
\draw  (1,1)  -- (2,-1/2);
\draw  (2,3)-- (2,-1/2);
\end{tikzpicture}
\caption{Triangulace šesti bodů}
\end{figure}  

Získali jsme tak rovinný graf s původními body jako vrcholy. Pokud je počet hran menší než $n$, provedeme triangulaci znovu s větším počtem bodů. Pokud je počet hran větší než $n$, odstraníme potřebný počet náhodně zvolených hran.

Viz obrázek TODO, uzel vytvořený z triangulace.

\subsubsection{Implementace}

Triangulace bodů je snadno implementovatelný geometrický problém. 


Se získaným rovinným grafem pracujeme jako s množinou vrcholů a k nim příslušným hranám seřazeným v pořadí, jak k danému vrcholu přiléhají. Z této struktury je již možné získat PD notaci příslušného linku.


V PD notaci lze procházkou po vláknu snadno poznat, jestli je vygenerovaný link uzlem. Také jsme v jednoduchou operací schopni uzel změnit na alternující, tedy takový, v němž se střídají křížení vedená zdola a zvrchu.

Jsme tedy schopni nagenerovat uzly, alternující uzly a linky libovolné velikosti.

Takto generované uzly jsou také poměrně \uv{zamotané}, tedy první rozmotávací krok algoritmu neodstraní příliš mnoho křížení.

\subsection{Test}

\begin{figure}[p]\centering
\includegraphics{../img/knotsFIT}
\caption{Graf dob běhu algoritmů na náhodných uzlech proložené křivkami, logaritmická škála.}
\label{obr03:knotSrov}
\end{figure}

\begin{figure}[p]\centering
\includegraphics{../img/alt_knotsFIT}
\caption{Graf dob běhu algoritmů na náhodných alternujících uzlech proložené křivkami, logaritmická škála.}
\label{obr03:altSrov}
\end{figure}

\begin{figure}[p]\centering
\includegraphics{../img/linksFIT}
\caption{Graf dob běhu algoritmů na náhodných lincích proložené křivkami, logaritmická škála.}
\label{obr03:linkSrov}
\end{figure}

Rychlost algoritmů jsme otestovali na uzlech, viz graf~\ref{obr03:knotSrov}, alternujících uzlech, viz graf~\ref{obr03:altSrov}, a lincích, viz graf~\ref{obr03:linkSrov}, s počtem křížení $n \leq 46$. 

Získaná data jsme použitím lineární regrese proložili exponenciálními křivkami tvaru $c 2^{kn}$, kde $c$ je určitá  konstanta a $k$ je hledaný parametr. Dostali jsme tedy odhad průměrné časové složitosti $\mathcal{O}(2^{kn})$, viz tabulka~\ref{datatab}.

Podle výsledků Jonesův polynom nejrychleji počítá algoritmus A, který volí křížení ve stěně ohraničené dvěma hranami. Odhad jeho průměrné časové složitosti na uzlech a lincích je $\mathcal{O}(2^{0,49n})$, na alternujících uzlech $\mathcal{O}(2^{0.468 n})$. Volba tohoto křížení tedy v průměru vede k většímu rozmotávání než volba křížení ve stěně typu B nebo náhodná volba křížení. 

Algoritmus B dosahuje různých výsledků v závislosti na druhu dat. Na lincích má podobnou průměrnou časovou složitost jako algoritmus A, ovšem na alternujících uzlech odhaduje jeho průměrnou složitost $\mathcal{O}(2^{0,519 n})$, což je ze všech variant nejvíce. Odpovídá to i výsledku testování na tabulkových uzlech, kde byl tento algoritmus také nejpomalejší, neboť v tabulce bývá uzel zaznamenán v alternujícím nakreslení, pokud takové nakreslení existuje. Ačkoli tedy algoritmus B zaručuje ze všech algoritmů u synů největší rozmotání, viz sekce~\ref{steny}, může na určitých datech běžet nejpomaleji. Na obecných uzlech ovšem dostáváme podobný odhad průměrné složitosti jako u algoritmu A.

Výsledky algoritmu RND se také liší podle druhu testovaných dat. Nejlépe se mu daří na alternujících uzlech, kde průměrnou složitost odhadujeme $\mathcal{O}(2^{0,509 n})$. Naopak nejpomalejší je na lincích s odhadem $\mathcal{O}(2^{0,555 n})$. Náhodná volba křížení pravděpodobně vede k rozpadání na disjuntkní uzly, což prodlužuje výpočet.

\begin{table}[t]
\centering
  \begin{tabular}{*{8}{c}}
    \toprule
       & A & chyba A & B & chyba B &  RND & chyba RND \\ 
    \midrule
    Uzly  & 0,487 & $\pm$ 0,020  &   0,503 & $\pm$ 0,036   &  0,520 & $\pm$ 0,024\\
    Alternující uzly & 0,468  & $\pm$ 0,030 &  0,519 & $\pm$  0,033 & 0,509 & $\pm$ 0,036\\
    Linky  & 0,486 &  $\pm$ 0,024 &   0,485 & $\pm$  0,032  &   0,555 & $\pm$ 0,024\\
    \bottomrule
  \end{tabular}
    \caption{Odhady parametru $k$ průměrné časové složitosti $\mathcal{O}(2^{kn})$ jednotlivých algoritmů podle druhu dat.} \label{datatab}

\end{table} 


\section{Torusové uzly} \label{torus}



Rychlost algoritmů jsme vyzkoušeli na 36 nejmenších torusových uzlech. Jejich PD notaci jsme získali z databáze Knot Atlas~\cite{knotatlas}.

Na grafu dob běhu algoritmů lze rozlišit dva shluky bodů, viz graf~\ref{obr03:torusSrov}. Spodní shluk odpovídá torusovým uzlům ($2k+1$, 2), tedy těm, které se obmotají dvakrát podél osy rotace torusu a jejich diagram má tvar dvou zakroucených vláken s $2k+1$ kříženími.

\begin{figure}[H]\centering
\begin{tikzpicture}[use Hobby shortcut, scale=0.75]
\begin{knot}[
  consider self intersections=true,
%  draft mode=crossings,
  flip crossing/.list={2,4,6} 
]
\strand ([closed]90:2) foreach \k in {1,...,7} { .. (90-360/7+\k*720/7:1.5) .. (90+\k*720/7:2) } (90:2);
\end{knot}
\end{tikzpicture}
\caption{Torusový uzel (7,2).}
\label{obr03:torus7}
\end{figure}

\begin{figure}[p]\centering
\includegraphics{../img/torusSrov}
\caption{Graf dob běhu algoritmů na 36 torusových uzlech, logaritmická škála.}
\label{obr03:torusSrov}
\end{figure}

\begin{figure}[p]\centering
\includegraphics{../img/torus2}
\caption{Doby běhu algoritmů na torusových uzlech (3,2) až (35,2).}
\label{obr03:torus2}
\end{figure}

Všechny stěny těchto uzlů jsou ohraničené pouze dvěma hranami. Rozpojením libovolného křížení jedním směrem vznikne torusový link ($2k$, 2), druhým směrem triviální uzel, který lze rozmotat několika prvními Reidemeistrovými pohyby. Z linku zase rozpojením libovolného křížení vznikne uzel ($2k-1$, 2). Rozpojení a rozmotávání má lineární časovou složitost, celkově tedy všechny tři algoritmy spočítají Jonesův polynom tohoto typu torusových uzlů v kvadratickém čase, což lze pozorovat na grafu~\ref{obr03:torus2}.

\begin{figure}[p]\centering
\includegraphics{../img/torusNe2FIT}
\caption{Doby běhu algoritmů na malých torusových uzlech ($p$, $q\neq 2$) proložené křivkami, logaritmická škála.}
\label{obr03:torusFIT}
\end{figure}

Na torusových uzlech tvaru ($p$, $q$), kde $q\neq 2$ již doba běhu algoritmu roste exponenciálně, viz graf~\ref{obr03:torusFIT}). Opět jsme provedli odhad průměrných časových složitostí, viz tabulka~\ref{torustab}.

\begin{table}[b]
\centering
  \begin{tabular}{*{8}{c}}
    \toprule
       & A & chyba A & B & chyba B &  RND & chyba RND \\ 
    \midrule
      & 0,533 & $\pm$ 0,032  &   0,638 & $\pm$ 0,048   &  0,572 & $\pm$ 0,035\\
    \bottomrule
  \end{tabular}
    \caption{Odhady parametru $k$ průměrné časové složitosti $\mathcal{O}(2^{kn})$ jednotlivých algoritmů na typu torusových uzlech ($p$, $q\neq 2$) .} \label{torustab}
    
\end{table}

Všechny varianty algoritmů jsou na torusových uzlích pomalejší než na náhodných datech. Nejrychlejší je opět algoritmus A s průměrnou časovou složitostí $\mathcal{O}(2^{0,533 n})$. Naopak nejpomalejší je algoritmus B se složitostí $\mathcal{O}(2^{0,638 n})$, což je nejvyšší složitost, kterou jsme při testování získali.